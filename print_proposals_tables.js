const funds_received = [
  {
    proposal_id: 10,
    funds_recevied: 3649.338,
  },
  {
    proposal_id: 24,
    funds_recevied: 201.92,
  },
  {
    proposal_id: 33,
    funds_recevied: 3635.412,
  },
  {
    proposal_id: 34,
    funds_recevied: 1947.278,
  },
  {
    proposal_id: 36,
    funds_recevied: 3790.831,
  },
  {
    proposal_id: 37,
    funds_recevied: 466.962,
  },
  {
    proposal_id: 39,
    funds_recevied: 9247.745,
  },
  {
    proposal_id: 42,
    funds_recevied: 4353.914,
  },
  {
    proposal_id: 44,
    funds_recevied: 969.674,
  },
  {
    proposal_id: 50,
    funds_recevied: 12153.132,
  },
  {
    proposal_id: 51,
    funds_recevied: 43.413,
  },
  {
    proposal_id: 52,
    funds_recevied: 177182.262,
  },
  {
    proposal_id: 54,
    funds_recevied: 18.729,
  },
  {
    proposal_id: 55,
    funds_recevied: 16619.32,
  },
  {
    proposal_id: 56,
    funds_recevied: 5.414,
  },
  {
    proposal_id: 61,
    funds_recevied: 5861.46,
  },
  {
    proposal_id: 63,
    funds_recevied: 163.121,
  },
  {
    proposal_id: 64,
    funds_recevied: 3956.2,
  },
  {
    proposal_id: 66,
    funds_recevied: 21132.95,
  },
  {
    proposal_id: 68,
    funds_recevied: 34039.665,
  },
  {
    proposal_id: 70,
    funds_recevied: 13201.416,
  },
  {
    proposal_id: 80,
    funds_recevied: 31872.218,
  },
  {
    proposal_id: 87,
    funds_recevied: 709.34,
  },
  {
    proposal_id: 88,
    funds_recevied: 37093.377,
  },
  {
    proposal_id: 91,
    funds_recevied: 329.472,
  },
  {
    proposal_id: 95,
    funds_recevied: 982.182,
  },
  {
    proposal_id: 97,
    funds_recevied: 98739.882,
  },
  {
    proposal_id: 98,
    funds_recevied: 34071.02,
  },
  {
    proposal_id: 100,
    funds_recevied: 29910.7,
  },
  {
    proposal_id: 105,
    funds_recevied: 59197.5,
  },
  {
    proposal_id: 109,
    funds_recevied: 19968.3,
  },
  {
    proposal_id: 110,
    funds_recevied: 1214.096,
  },
  {
    proposal_id: 114,
    funds_recevied: 5213.576,
  },
  {
    proposal_id: 119,
    funds_recevied: 2758.125,
  },
  {
    proposal_id: 124,
    funds_recevied: 20118.23,
  },
  {
    proposal_id: 128,
    funds_recevied: 3328.0,
  },
  {
    proposal_id: 133,
    funds_recevied: 142274.375,
  },
  {
    proposal_id: 134,
    funds_recevied: 1107.614,
  },
  {
    proposal_id: 138,
    funds_recevied: 75828.396,
  },
  {
    proposal_id: 140,
    funds_recevied: 34719.68,
  },
  {
    proposal_id: 141,
    funds_recevied: 119139.141,
  },
  {
    proposal_id: 142,
    funds_recevied: 8985.6,
  },
  {
    proposal_id: 146,
    funds_recevied: 4056.451,
  },
  {
    proposal_id: 147,
    funds_recevied: 54819.372,
  },
  {
    proposal_id: 150,
    funds_recevied: 3983.022,
  },
  {
    proposal_id: 151,
    funds_recevied: 9470.958,
  },
  {
    proposal_id: 154,
    funds_recevied: 1872.792,
  },
  {
    proposal_id: 158,
    funds_recevied: 201777.84,
  },
  {
    proposal_id: 159,
    funds_recevied: 867824.682,
  },
  {
    proposal_id: 160,
    funds_recevied: 58226.486,
  },
  {
    proposal_id: 161,
    funds_recevied: 65977.092,
  },
  {
    proposal_id: 162,
    funds_recevied: 269.36,
  },
  {
    proposal_id: 163,
    funds_recevied: 34539.53,
  },
  {
    proposal_id: 166,
    funds_recevied: 1702995.832,
  },
  {
    proposal_id: 167,
    funds_recevied: 100310.346,
  },
  {
    proposal_id: 169,
    funds_recevied: 3016786.71,
  },
  {
    proposal_id: 174,
    funds_recevied: 105959.28,
  },
  {
    proposal_id: 175,
    funds_recevied: 1996954.848,
  },
  {
    proposal_id: 180,
    funds_recevied: 6984.592,
  },
  {
    proposal_id: 181,
    funds_recevied: 6615.9,
  },
  {
    proposal_id: 185,
    funds_recevied: 38163.368,
  },
  {
    proposal_id: 187,
    funds_recevied: 1527.514,
  },
  {
    proposal_id: 188,
    funds_recevied: 30345.184,
  },
  {
    proposal_id: 189,
    funds_recevied: 142361.105,
  },
  {
    proposal_id: 190,
    funds_recevied: 9073.785,
  },
  {
    proposal_id: 191,
    funds_recevied: 12795586.149,
  },
  {
    proposal_id: 192,
    funds_recevied: 139.992,
  },
  {
    proposal_id: 193,
    funds_recevied: 5621.899,
  },
  {
    proposal_id: 194,
    funds_recevied: 117726.268,
  },
  {
    proposal_id: 195,
    funds_recevied: 10000.023,
  },
  {
    proposal_id: 196,
    funds_recevied: 35840.322,
  },
  {
    proposal_id: 197,
    funds_recevied: 132979.203,
  },
  {
    proposal_id: 199,
    funds_recevied: 56591.876,
  },
  {
    proposal_id: 201,
    funds_recevied: 30589.687,
  },
  {
    proposal_id: 202,
    funds_recevied: 90000.203,
  },
  {
    proposal_id: 205,
    funds_recevied: 50000.283,
  },
  {
    proposal_id: 209,
    funds_recevied: 7127.573,
  },
  {
    proposal_id: 211,
    funds_recevied: 5998.383,
  },
  {
    proposal_id: 213,
    funds_recevied: 29327444.135,
  },
  {
    proposal_id: 214,
    funds_recevied: 120037.874,
  },
  {
    proposal_id: 215,
    funds_recevied: 70113.946,
  },
  {
    proposal_id: 216,
    funds_recevied: 141862.916,
  },
  {
    proposal_id: 217,
    funds_recevied: 17640.66,
  },
  {
    proposal_id: 219,
    funds_recevied: 107474.355,
  },
  {
    proposal_id: 221,
    funds_recevied: 24989.934,
  },
  {
    proposal_id: 222,
    funds_recevied: 51430.805,
  },
  {
    proposal_id: 223,
    funds_recevied: 214975.58,
  },
  {
    proposal_id: 227,
    funds_recevied: 100000.083,
  },
  {
    proposal_id: 228,
    funds_recevied: 25456.746,
  },
  {
    proposal_id: 229,
    funds_recevied: 79270.132,
  },
  {
    proposal_id: 230,
    funds_recevied: 49999.938,
  },
  {
    proposal_id: 231,
    funds_recevied: 140036.1,
  },
  {
    proposal_id: 233,
    funds_recevied: 45460313.316,
  },
  {
    proposal_id: 234,
    funds_recevied: 49368.8,
  },
  {
    proposal_id: 237,
    funds_recevied: 79577.32,
  },
  {
    proposal_id: 239,
    funds_recevied: 36369.228,
  },
  {
    proposal_id: 240,
    funds_recevied: 117766.209,
  },
  {
    proposal_id: 241,
    funds_recevied: 193333.024,
  },
  {
    proposal_id: 242,
    funds_recevied: 90000.104,
  },
  {
    proposal_id: 244,
    funds_recevied: 6384.126,
  },
  {
    proposal_id: 245,
    funds_recevied: 134937.156,
  },
  {
    proposal_id: 247,
    funds_recevied: 83323.209,
  },
  {
    proposal_id: 248,
    funds_recevied: 53686.942,
  },
  {
    proposal_id: 250,
    funds_recevied: 54776.476,
  },
  {
    proposal_id: 253,
    funds_recevied: 12477.576,
  },
  {
    proposal_id: 254,
    funds_recevied: 249999.947,
  },
  {
    proposal_id: 259,
    funds_recevied: 250000.641,
  },
  {
    proposal_id: 260,
    funds_recevied: 11781.525,
  },
  {
    proposal_id: 261,
    funds_recevied: 121110.11,
  },
  {
    proposal_id: 262,
    funds_recevied: 219600.16,
  },
  {
    proposal_id: 263,
    funds_recevied: 144936.135,
  },
  {
    proposal_id: 264,
    funds_recevied: 4398004.165,
  },
  {
    proposal_id: 265,
    funds_recevied: 20012.512,
  },
  {
    proposal_id: 266,
    funds_recevied: 256136.052,
  },
  {
    proposal_id: 268,
    funds_recevied: 249999.6,
  },
  {
    proposal_id: 269,
    funds_recevied: 177065.829,
  },
  {
    proposal_id: 272,
    funds_recevied: 99999.84,
  },
  {
    proposal_id: 275,
    funds_recevied: 118662.003,
  },
  {
    proposal_id: 276,
    funds_recevied: 10999.824,
  },
  {
    proposal_id: 277,
    funds_recevied: 149999.76,
  },
  {
    proposal_id: 278,
    funds_recevied: 6750.01,
  },
  {
    proposal_id: 279,
    funds_recevied: 53347.697,
  },
  {
    proposal_id: 280,
    funds_recevied: 94755.074,
  },
  {
    proposal_id: 281,
    funds_recevied: 99999.84,
  },
  {
    proposal_id: 282,
    funds_recevied: 11148.135,
  },
  {
    proposal_id: 283,
    funds_recevied: 97524.104,
  },
  {
    proposal_id: 284,
    funds_recevied: 63899.516,
  },
  {
    proposal_id: 287,
    funds_recevied: 1164.534,
  },
  {
    proposal_id: 288,
    funds_recevied: 2184001.248,
  },
  {
    proposal_id: 292,
    funds_recevied: 42510.244,
  },
  {
    proposal_id: 293,
    funds_recevied: 57388.759,
  },
  {
    proposal_id: 294,
    funds_recevied: 67757.764,
  },
  {
    proposal_id: 296,
    funds_recevied: 299999.867,
  },
  {
    proposal_id: 297,
    funds_recevied: 17237.525,
  },
  {
    proposal_id: 300,
    funds_recevied: 299999.867,
  },
  {
    proposal_id: 301,
    funds_recevied: 8566.061,
  },
  {
    proposal_id: 303,
    funds_recevied: 88970.526,
  },
  {
    proposal_id: 304,
    funds_recevied: 43821.316,
  },
  {
    proposal_id: 306,
    funds_recevied: 70050.12,
  },
  {
    proposal_id: 307,
    funds_recevied: 299166.882,
  },
  {
    proposal_id: 308,
    funds_recevied: 1295002.496,
  },
  {
    proposal_id: 309,
    funds_recevied: 4999.92,
  },
  {
    proposal_id: 310,
    funds_recevied: 21717.396,
  },
  {
    proposal_id: 312,
    funds_recevied: 2999.952,
  },
  {
    proposal_id: 313,
    funds_recevied: 6894.339,
  },
  {
    proposal_id: 315,
    funds_recevied: 53688.512,
  },
  {
    proposal_id: 317,
    funds_recevied: 150000.107,
  },
];

const main = async () => {
  let prop_ids = [];
  for (let i = 1; i <= 321; i++) {
    prop_ids.push(i);
  }
  prop_ids = JSON.stringify(prop_ids);

  const res = await fetch("https://api.deathwing.me/", {
    headers: {
      accept: "application/json, text/plain, */*",
      "content-type": "application/json"
    },
    body: `{\"id\":4,\"jsonrpc\":\"2.0\",\"method\":\"condenser_api.find_proposals\",\"params\":[${prop_ids}]}`,
    method: "POST",
  });
  const data = await res.json();

  let numberFormatter = new Intl.NumberFormat("en-US", {
    style: "decimal",
    useGrouping: true,
  });

  for (const item of data.result) {
    let diff = Math.abs(
      new Date(item.end_date).getTime() - new Date(item.start_date).getTime()
    );
    let daysDiff = Math.round(diff / 86400000) - 1;
    let totalPay = numberFormatter.format(
      daysDiff * parseFloat(item.daily_pay).toFixed(3)
    );

    let pay_symbol = "SBD";
    if (
      new Date(item.start_date).getTime() >
      new Date("2020-03-20T00:00:00").getTime()
    ) {
      pay_symbol = "HBD";
    }

    let startDate = new Intl.DateTimeFormat("en-US", {
      year: "numeric",
      month: "short",
      day: "2-digit",
    }).format(new Date(item.start_date));
    let endDate = new Intl.DateTimeFormat("en-US", {
      year: "numeric",
      month: "short",
      day: "2-digit",
    }).format(new Date(item.end_date));

    const get_funds_received = (proposal_id) => {
      for (const entry of funds_received) {
        if (entry.proposal_id == proposal_id) {
          return numberFormatter.format(
            parseFloat(entry.funds_recevied).toFixed(3)
          );
        }
      }
      return "0.000";
    };
    const curr_funds_received = get_funds_received(item.proposal_id);

    console.log(
      `| ${item.proposal_id} | [${item.subject.replace("|","-")}](https://hive.blog/@${item.creator}/${item.permlink}) | ${item.creator} | ${startDate} - ${endDate} | ${totalPay} ${pay_symbol} | ${curr_funds_received} ${pay_symbol} |`
    );
  }
};

console.log(`| Proposal Number | Title | Creator | Date | Funds Requested | Funds Received |
| --- | --- | --- | --- | --- | --- |`);
main();
